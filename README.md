# Fram Control
##Библиотека для работы с энергонезависимой памятью.
###Данная библиотека содержит:
* **i2c_soft** - низкоуровневый программный драйвер шины i2c.
* **fram_data** - низкоуровневый драйвер энергонезависимой памяти
* **memory_rewrite_handler** - модуль записи/чтения данных в/из энергонезависимой памяти с обработкой ошибок.
* **memory_allocator** - модуль динамического распределения энергонезависимой памяти между потребителями.
* **data_manager** - модуль хранения данных, удобного доступа к ним и контроля их целостности
* **journal** - модуль работы с журналами. Позволяет создавать журналы, добавлять записи, читать произвольную запись, очищать журнал.

### Подробности в моем блоге:
* [Пример реализации софтового I2C на STM32](http://elisbred.blogspot.ru/2014/04/i2c-stm32.html)
* [Работа с энергонезависимой памятью на STM32](http://elisbred.blogspot.ru/2014/04/stm32.html)

### Минусы реализации:
* Макросы **DataManager_Write** и **DataManager_Read** читают и пишут данные в указанные пользователем буферы, но неизменяют структуру **DataManager_Data**. Такое поведение неочевидно. Пользователь ожидает, что в этой структуре данные так же будут обновлены.
* Автоматическое распределение энергонезависимой памяти может привести к тому, что при каждом запуске, ввиду некоторой дивиации модули могут запрашивать память в разном порядке. Следовательно они будут получать каждый раз разные участки памяти. Это необходимо учитывать в архитекруте программы и исключить всякие вариации инициализации журналов и модуля памяти.

### TODO:
* **[data_manager]** третья таблица данных для автоматического восстановления в случае ошибки одной.
* **[data_manager]** автоматическое обновление структуры DataManager_Data в случае использования макросов DataManager_Write и DataManager_Read.

### Контакты, ссылки
* elisey.rav@gmail.com
* [github.com/stm32_fram_control](https://github.com/medik88/stm32_fram_control)
* [elisbred.blogspot.ru](http://elisbred.blogspot.ru/)
